var spawn = require("child_process").spawn
var fs = require("fs");

var msg = [
	"train",
	"pca.pkl",
	"clf.pkl",
	"output.png",
	JSON.stringify([[0.557,0.461,0.1966,0.0342,0.00952,0.0405,0.0708,0.291,0.65555,0.75],[0.783,0.803,0.10721666666666667,0.0848,0.0159,0.0197,0.682,0.931,0.8232444444444444,1],[0.714,0.774,0.13205,0.0957,0.0986,0.178,0.214,0.635,0.4888222222222222,1],[0.643,0.413,0.20135,0.142,0.506,0.00197,0.067,0.457,0.8882833333333333,1],[0.498,0.95,0.09838333333333332,0.0736,0.000318,0.0000243,0.39,0.61,0.5073555555555556,1],[0.743,0.359,0.17335,0.0794,0.199,0.00611,0.137,0.587,0.88935,1],[0.875,0.437,0.18903333333333333,0.555,0.337,0,0.138,0.818,0.82695,1],[0.466,0.411,0.18153333333333332,0.0548,0.414,0.528,0.0973,0.106,0.7780055555555555,1],[0.529,0.403,0.11838333333333333,0.0349,0.123,0.496,0.0647,0.723,1.1107111111111112,0.75],[0.579,0.124,0.2431333333333333,0.0302,0.969,0.0912,0.0609,0.118,0.744561111111111,0.75],[0.31,0.252,0.22051666666666667,0.0384,0.673,0.00525,0.133,0.119,0.49361111111111106,1]])
].join("\n")

py = spawn("python", ["worker.py"])
py.stdout.on("data", function(data) {
	console.log(data.toString());
})
py.stdout.on("end", function() {
	var stats = fs.statSync("output.png")
	var fileSizeInBytes = stats["size"]
	console.log("Retrieving image at ./output.png with file size " + fileSizeInBytes.toString());
})
py.stdin.write(msg)
py.stdin.end();